<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Danh s√°ch s·∫£n ph·∫©m</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #f8f9fa;
            line-height: 1.6;
        }

        .navbar {
            background: #007bff;
            color: white;
            padding: 15px 0;
            margin-bottom: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }

        .navbar-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .navbar-brand {
            font-size: 24px;
            font-weight: bold;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .badge {
            background: rgba(255,255,255,0.2);
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
        }

        .btn {
            display: inline-block;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            text-decoration: none;
            cursor: pointer;
            font-size: 14px;
            text-align: center;
        }

        .btn-primary { background: #007bff; color: white; }
        .btn-success { background: #28a745; color: white; }
        .btn-warning { background: #ffc107; color: black; }
        .btn-danger { background: #dc3545; color: white; }
        .btn-secondary { background: #6c757d; color: white; }
        .btn-outline-light { background: transparent; color: white; border: 1px solid white; }

        .btn:hover { opacity: 0.9; }

        .card {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            padding: 20px;
        }

        .search-form {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            align-items: center;
        }

        .form-control {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .table th,
        .table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        .table th {
            background: #343a40;
            color: white;
            font-weight: bold;
        }

        .table tbody tr:nth-child(odd) {
            background: #f8f9fa;
        }

        .table tbody tr:hover {
            background: #e9ecef;
        }

        .text-center { text-align: center; }
        .text-end { text-align: right; }
        .text-success { color: #28a745; }
        .text-muted { color: #6c757d; }

        .d-flex { display: flex; }
        .justify-content-between { justify-content: space-between; }
        .align-items-center { align-items: center; }

        .mb-3 { margin-bottom: 15px; }
        .me-2 { margin-right: 10px; }

        h2 {
            color: #333;
            margin-bottom: 20px;
        }

        .empty-state {
            text-align: center;
            padding: 40px;
            color: #6c757d;
        }

        .table-responsive {
            overflow-x: auto;
        }

        @media (max-width: 768px) {
            .search-form {
                flex-direction: column;
            }

            .btn {
                width: 100%;
                margin-bottom: 10px;
            }

            .navbar-content {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
<!-- Navigation Bar -->
<nav class="navbar">
    <div class="container">
        <div class="navbar-content">
            <div class="navbar-brand">
                üè™ Qu·∫£n l√Ω s·∫£n ph·∫©m
            </div>
            <div class="user-info">
                    <span>
                        üë§ Xin ch√†o, <strong th:text="${user != null ? user.name : 'Guest'}">Admin</strong>
                        <span class="badge" th:text="${user != null ? user.roleName : 'Guest'}">Qu·∫£n tr·ªã vi√™n</span>
                    </span>
                <a class="btn btn-outline-light" th:href="@{/logout}">
                    üö™ ƒêƒÉng xu·∫•t
                </a>
            </div>
        </div>
    </div>
</nav>

<div class="container">

    <!-- Header v·ªõi n√∫t th√™m -->
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h2>üì¶ Danh s√°ch s·∫£n ph·∫©m</h2>
        <div th:if="${user != null and user.isAdmin()}">
            <a th:href="@{/products/create}" class="btn btn-success">
                ‚ûï Th√™m s·∫£n ph·∫©m m·ªõi
            </a>
        </div>
    </div>

    <!-- Form t√¨m ki·∫øm -->
    <div class="card">
        <form th:action="@{/products}" method="get" class="search-form">
            <input type="text"
                   class="form-control"
                   name="search"
                   th:value="${search}"
                   placeholder="üîç T√¨m ki·∫øm theo t√™n s·∫£n ph·∫©m...">
            <button type="submit" class="btn btn-primary">
                üîç T√¨m ki·∫øm
            </button>
            <a th:href="@{/products}" class="btn btn-secondary">
                üîÑ X√≥a b·ªô l·ªçc
            </a>
        </form>
    </div>

    <!-- B·∫£ng s·∫£n ph·∫©m -->
    <div class="card">
        <!-- Hi·ªÉn th·ªã s·ªë l∆∞·ª£ng k·∫øt qu·∫£ -->
        <div class="mb-3">
                <span class="text-muted">
                    T√¨m th·∫•y <strong th:text="${products != null ? #lists.size(products) : 0}">0</strong> s·∫£n ph·∫©m
                    <span th:if="${search != null and search != ''}"
                          th:text="'cho t·ª´ kh√≥a: &quot;' + ${search} + '&quot;'"></span>
                </span>
        </div>

        <!-- B·∫£ng responsive -->
        <div class="table-responsive">
            <table class="table">
                <thead>
                <tr>
                    <th>üÜî ID</th>
                    <th>üì¶ T√™n s·∫£n ph·∫©m</th>
                    <th>üí∞ Gi√°</th>
                    <th>üìä S·ªë l∆∞·ª£ng</th>
                    <th>üìÖ Ng√†y</th>
                    <th>üè∑Ô∏è Danh m·ª•c</th>
                    <th th:if="${user != null and user.isAdmin()}">‚öôÔ∏è Thao t√°c</th>
                </tr>
                </thead>
                <tbody>
                <!-- L·∫∑p qua danh s√°ch s·∫£n ph·∫©m -->
                <tr th:each="product : ${products}" th:if="${products != null}">
                    <td th:text="${product.id}">1</td>
                    <td>
                        <strong th:text="${product.name}">T√™n s·∫£n ph·∫©m</strong>
                    </td>
                    <td class="text-end">
                                <span class="text-success"
                                      th:text="${product.price != null ? (#numbers.formatDecimal(product.price, 0, 'COMMA', 0, 'POINT') + ' VND') : '0 VND'}">
                                    25,000 VND
                                </span>
                    </td>
                    <td class="text-center">
                        <span th:text="${product.quantity}">100</span>
                    </td>
                    <td th:text="${product.date != null ? #temporals.format(product.date, 'dd/MM/yyyy') : ''}">28/06/2025</td>
                    <td>
                        <span th:text="${product.category != null ? product.category.name : 'N/A'}">Danh m·ª•c</span>
                    </td>

                    <!-- C·ªôt thao t√°c ch·ªâ cho admin -->
                    <td th:if="${user != null and user.isAdmin()}">
                        <!-- N√∫t s·ª≠a -->
                        <a th:href="@{/products/edit/{id}(id=${product.id})}"
                           class="btn btn-warning me-2"
                           title="S·ª≠a s·∫£n ph·∫©m">
                            ‚úèÔ∏è S·ª≠a
                        </a>

                        <!-- N√∫t x√≥a -->
                        <a th:href="@{/products/delete/{id}(id=${product.id})}"
                           class="btn btn-danger"
                           title="X√≥a s·∫£n ph·∫©m"
                           onclick="return confirm('‚ùå B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a s·∫£n ph·∫©m n√†y kh√¥ng?')">
                            üóëÔ∏è X√≥a
                        </a>
                    </td>
                </tr>

                <!-- Hi·ªÉn th·ªã khi kh√¥ng c√≥ d·ªØ li·ªáu -->
                <tr th:if="${products == null or #lists.isEmpty(products)}">
                    <td th:colspan="${user != null and user.isAdmin() ? '7' : '6'}"
                        class="text-center empty-state">
                        <div>
                            üì≠
                            <br><br>
                            <span th:if="${search != null and search != ''}">
                                        Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m n√†o v·ªõi t·ª´ kh√≥a "<span th:text="${search}"></span>"
                                    </span>
                            <span th:unless="${search != null and search != ''}">
                                        Ch∆∞a c√≥ s·∫£n ph·∫©m n√†o trong h·ªá th·ªëng
                                    </span>
                        </div>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
</body>
</html>